let MaliciousExtensions = dynamic([#LIST OF CHROME EXTENION IDS#]);
union isfuzzy=true DeviceFileEvents, DeviceRegistryEvents, DeviceProcessEvents, DeviceEvents, DeviceImageLoadEvents
| where Timestamp > ago(24h)
| project Timestamp, DeviceName, FolderPath, FileName, RegistryValueData, InitiatingProcessCommandLine, ProcessCommandLine
//Fields that would only contain the extension ID
| extend SearchBlob = strcat(
    tostring(FolderPath), " ",
    tostring(FileName), " ",
    tostring(RegistryValueData), " ",
    tostring(ProcessCommandLine), " ",
    tostring(InitiatingProcessCommandLine)
)
| where SearchBlob has_any (MaliciousExtensions)
| sort by Timestamp desc




OR TO ASSSIST WITH LOWERING RESOURCE USAGE 

let MaliciousExtensions = dynamic([#LIST OF CHROME EXTENION IDS#]);
let StartTime = ago(24h);

union isfuzzy=true
(
  DeviceProcessEvents
  | where Timestamp > StartTime
  | project Timestamp, DeviceName, FolderPath, FileName, RegistryValueData, InitiatingProcessCommandLine, ProcessCommandLine
  // cheap pre-filter: only the columns that plausibly contain IDs
  | where ProcessCommandLine has_any (MaliciousExtensions)
     or InitiatingProcessCommandLine has_any (MaliciousExtensions)
),
(
  DeviceRegistryEvents
  | where Timestamp > StartTime
  | project Timestamp, DeviceName, FolderPath, FileName, RegistryValueData, InitiatingProcessCommandLine, ProcessCommandLine
  | where RegistryValueData has_any (MaliciousExtensions)
),
(
  DeviceFileEvents
  | where Timestamp > StartTime
  | project Timestamp, DeviceName, FolderPath, FileName, RegistryValueData, InitiatingProcessCommandLine, ProcessCommandLine
  | where FolderPath has_any (MaliciousExtensions)
     or FileName has_any (MaliciousExtensions)
),
(
  DeviceEvents
  | where Timestamp > StartTime
  | project Timestamp, DeviceName, FolderPath, FileName, RegistryValueData, InitiatingProcessCommandLine, ProcessCommandLine
),
(
  DeviceImageLoadEvents
  | where Timestamp > StartTime
  | project Timestamp, DeviceName, FolderPath, FileName, RegistryValueData, InitiatingProcessCommandLine, ProcessCommandLine
)
| extend SearchBlob = strcat(tostring(FolderPath)," ",tostring(FileName)," ",tostring(RegistryValueData)," ",tostring(ProcessCommandLine)," ",tostring(InitiatingProcessCommandLine))
| where SearchBlob has_any (MaliciousExtensions)
| sort by Timestamp desc
